<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TT Locmaria-Plouzané</title>
  <link rel="stylesheet" href="css/styles.css">
 <!-- jsPDF + AutoTable -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

</head>
<body>
  <div class="page-wrapper">
  <section class="top_page">
    <header>
      <img src="images/logo_TT_LOC.png" alt="Logo TT Locmaria-Plouzané" class="logo">

      <h1 class="big_title">
        <span class="title-full">TT LOCMARIA PLOUZANÉ</span>
        <span class="title-medium">TT LOCMARIA</span>
        <span class="title-small">TT LOC</span>
      </h1>

      <nav class="nav">
        <button class="menu-toggle">☰</button>
        <ul class="nav-links">
          <li><a href="index.html">Accueil</a></li>
          <li class="dropdown">
            <a href="#">Club</a>
              <ul class="dropdown-content">
                <li><a href="horraires.html">Horaires</a></li>
                <li><a href="adresse.html">Adresse</a></li>
                <li><a href="tarifs.html">Tarifs</a></li>
                <li><a href="#">Inscription</a></li>
                <li><a href="#">Contact</a></li>
              </ul>
          </li>
          <li><a href="#">News</a></li>
          <li><a href="boutique.html">Boutique</a></li>
          <li class="dropdown">
            <a href="#">Tournoi</a>
              <ul class="dropdown-content">
                <li><a href="tournoi_double_hiver.html">Tournoi de Double d'Hiver</a></li>
              </ul>
          </li>

          <li><a href="#">Connexion</a></li>
        </ul>
      </nav>
    </header>
    <div class="landing_page"></div>
  </section>

  <section class="tournoi-section">
  <div class="tournoi-title">
  <h1>Tournoi de double d’hiver</h1>
  </div>
  <div class="tournoi-intro">
  <p>
    Venez participer à notre tournoi de double d’hiver !  
    Inscrivez-vous en ligne en remplissant le formulaire ci-dessous.
  </p>
  </div>

  <div class="tournoi-content">
    <!-- Affiche du tournoi -->
    <div class="tournoi-affiche">
      <img src="images/affiche_tournoi.jpg" alt="Affiche du tournoi de double d’hiver">
    </div>

   <!-- Formulaire d'inscription -->
<div class="tournoi-form">
  <form id="tournoiForm">
    <label for="nom1">Nom et prénom joueur 1 :</label>
    <input type="text" id="nom1" name="nom1" required>

    <label for="club1">Club joueur 1 :</label>
    <input type="text" id="club1" name="club1">

    <label for="licence1">Numéro de licence joueur 1 :</label>
    <input type="text" id="licence1" name="licence1">

    <label for="points1">points joueur 1 (début Phase 2):</label>
    <input type="text" id="points1" name="points1">

    <hr>

    <label for="nom2">Nom et prénom joueur 2 :</label>
    <input type="text" id="nom2" name="nom2" required>

    <label for="club2">Club joueur 2 :</label>
    <input type="text" id="club2" name="club2">

    <label for="licence2">Numéro de licence joueur 2 :</label>
    <input type="text" id="licence2" name="licence2">

    <label for="points2">points joueur 2 (début Phase 2):</label>
    <input type="text" id="points2" name="points2">

    <hr>

 <label>Choix du tableau :</label>
<div class="checkbox-group">
  <div class="checkbox-item">
    <input type="checkbox" id="tableau1600" name="tableau1600">
    <label for="tableau1600">-1600 PTS</label>
  </div>
  <div class="checkbox-item">
    <input type="checkbox" id="tableau2400" name="tableau2400">
    <label for="tableau2400">-2400 PTS</label>
  </div>
</div>

    <button type="submit">S'inscrire</button>
  </form>

  <script>
const form = document.getElementById("tournoiForm");

form.addEventListener("submit", e => {
  e.preventDefault(); // empêche le rechargement de la page

  const data = new FormData(form);

  fetch("https://script.google.com/macros/s/AKfycbxLvpblCx756b-XkknhXx1YGJsddUMBUMAAxZsIeDlRm6Qedze2fF52fNXnP0Av15W5Hw/exec", {
    method: "POST",
    body: data
  })
  .then(response => {
    if (response.ok) alert("Inscription enregistrée !");
    else alert("Erreur lors de l'envoi.");
    form.reset();
  })
  .catch(error => {
    console.error("Erreur :", error);
    alert("Erreur réseau.");
  });
});
</script>



</div>
  </div>
<section class="tournoi-section">

  <!-- Tableau des inscrits -1600 -->
  <h2>Inscrits -1600 PTS</h2>
  <div class="table-container">
    <table id="inscrits1600">
      <thead>
        <tr>
          <th>Date</th>
          <th>Nom Joueur 1</th>
          <th>Club 1</th>
          <th>Licence 1</th>
          <th>Points 1</th>
          <th>Nom Joueur 2</th>
          <th>Club 2</th>
          <th>Licence 2</th>
          <th>Points 2</th>
          <th>Total Points</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  <button id="pdf1600" class="btn-pdf">Télécharger -1600 PTS en PDF</button>

  <!-- Tableau des inscrits -2400 -->
  <h2>Inscrits -2400 PTS</h2>
  <div class="table-container">
    <table id="inscrits2400">
      <thead>
        <tr>
          <th>Date</th>
          <th>Nom Joueur 1</th>
          <th>Club 1</th>
          <th>Licence 1</th>
          <th>Points 1</th>
          <th>Nom Joueur 2</th>
          <th>Club 2</th>
          <th>Licence 2</th>
          <th>Points 2</th>
          <th>Total Points</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  <button id="pdf2400" class="btn-pdf">Télécharger -2400 PTS en PDF</button>
  <button id="pdfAll" class="btn-pdf">Télécharger tous les inscrits en PDF</button>

</section>

<script>
const SHEET_URL = "https://script.google.com/macros/s/AKfycbwBarG7gRqMby2FxqpmA3aNZkyxci5jQHkJuZAOT7v1sEIH4GAeYEwNcCB9RDgTIUM/exec";

// Récupération des inscrits depuis Google Sheets
fetch(SHEET_URL)
  .then(res => res.json())
  .then(data => {
    const tbody1600 = document.querySelector("#inscrits1600 tbody");
    const tbody2400 = document.querySelector("#inscrits2400 tbody");
    tbody1600.innerHTML = "";
    tbody2400.innerHTML = "";

    data.forEach(r => {
      const tr = `<tr>
        <td>${r.date || ""}</td>
        <td>${r.nom1 || ""}</td>
        <td>${r.club1 || ""}</td>
        <td>${r.licence1 || ""}</td>
        <td>${r.points1 || ""}</td>
        <td>${r.nom2 || ""}</td>
        <td>${r.club2 || ""}</td>
        <td>${r.licence2 || ""}</td>
        <td>${r.points2 || ""}</td>
        <td>${r.totalPoints || ""}</td>
      </tr>`;

      if (r.tableau1600 === "Oui") tbody1600.innerHTML += tr;
      if (r.tableau2400 === "Oui") tbody2400.innerHTML += tr;
    });
  })
  .catch(err => {
    console.error("Erreur lors du chargement :", err);
    document.querySelector("#inscrits1600 tbody").innerHTML =
      "<tr><td colspan='10'>Erreur de chargement des inscrits</td></tr>";
    document.querySelector("#inscrits2400 tbody").innerHTML =
      "<tr><td colspan='10'>Erreur de chargement des inscrits</td></tr>";
  });

// Fonction pour générer un PDF à partir d'un tableau HTML
function generatePDF(tableId, title) {
  const { jsPDF } = window.jspdf;
  const rows = Array.from(document.querySelectorAll(`#${tableId} tbody tr`));
  if (!rows.length) {
    alert("Aucun inscrit pour " + title);
    return;
  }

  const doc = new jsPDF();
  doc.setFontSize(14);
  doc.text(title, 10, 10);

  const tableData = rows.map(tr => Array.from(tr.querySelectorAll("td")).map(td => td.textContent));

  doc.autoTable({
    head: [Array.from(document.querySelectorAll(`#${tableId} thead th`)).map(th => th.textContent)],
    body: tableData,
    startY: 20
  });

  doc.save(title + ".pdf");
}

// Boutons PDF
document.getElementById("pdf1600").addEventListener("click", () => generatePDF("inscrits1600", "-1600 PTS"));
document.getElementById("pdf2400").addEventListener("click", () => generatePDF("inscrits2400", "-2400 PTS"));
</script>
<script>
document.getElementById("pdfAll").addEventListener("click", () => {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(14);
  doc.text("Tous les inscrits", 10, 10);

  // Récupérer les lignes des deux tableaux
  const rows1600 = Array.from(document.querySelectorAll("#inscrits1600 tbody tr"));
  const rows2400 = Array.from(document.querySelectorAll("#inscrits2400 tbody tr"));

  if (rows1600.length === 0 && rows2400.length === 0) {
    alert("Aucun inscrit pour le moment.");
    return;
  }

  // Transformer en array de données
  const tableData = [
    ...rows1600.map(tr => Array.from(tr.querySelectorAll("td")).map(td => td.textContent)),
    ...rows2400.map(tr => Array.from(tr.querySelectorAll("td")).map(td => td.textContent))
  ];

  // En-têtes (utiliser ceux du premier tableau)
  const headers = Array.from(document.querySelectorAll("#inscrits1600 thead th")).map(th => th.textContent);

  doc.autoTable({
    head: [headers],
    body: tableData,
    startY: 20
  });

  doc.save("Tous_les_inscrits.pdf");
});
</script>

  <script src="js/script.js" defer></script>
</div>
  <footer class="site-footer">
  <div class="footer-left">
    <img src="images/logo_TT_LOC.png" alt="Logo TT Locmaria-Plouzané" class="footer-logo">
  </div>

  <div class="footer-center">
    <p><strong>TT Locmaria-Plouzané</strong></p>
    <p>Adresse : Salle Omnisports Keralauraurent – Route de Pen Ar Menez 29280</p>
    <p>Téléphone : 06 71 86 03 17</p>
    <p>Email : <a href="mailto:tt.locmaria@gmail.com">tt.locmaria@gmail.com</a></p>
  </div>

  <div class="footer-right">
    <a href="https://www.facebook.com/tt.loc.860560" target="_blank" class="social-link">
      <img src="images/facebook.png" alt="Facebook" class="social-icon">
    </a>
    <p class="copyright">© 2025 TT LOC</p>
  </div>
</footer>
</body>

</html>